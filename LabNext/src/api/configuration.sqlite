PRAGMA foreign_keys = ON;
CREATE TABLE IF NOT EXISTS Items (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    price REAL NOT NULL,
    rating REAL NOT NULL,
    stock INTEGER NOT NULL,
    description TEXT,
    prevprice REAL,
    bias REAL
);
CREATE TABLE IF NOT EXISTS Users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT UNIQUE NOT NULL,
    hash TEXT NOT NULL,
    admin INTEGER DEFAULT 0,
    tokenRevision INTEGER DEFAULT 0
);
CREATE TABLE IF NOT EXISTS Tags (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEST NOT NULL,
    description TEXT
);
CREATE TABLE IF NOT EXISTS Orders (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    itemID INTEGER NOT NULL,
    destID INTEGER NOT NULL,
    count INTEGER NOT NULL,
    FOREIGN KEY (itemID) REFERENCES Items(id),
    FOREIGN KEY (destID) REFERENCES Destinations(id)
);
CREATE TABLE IF NOT EXISTS Destinations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    address TEXT NOT NULL,
    email TEXT,
    phone CHARACTER(20)
);
CREATE TABLE IF NOT EXISTS Previews (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    path TEXT NOT NULL,
    alt TEXT
);
CREATE TABLE IF NOT EXISTS ItemPreviews (
    itemID INTEGER NOT NULL,
    previewID INTEGER NOT NULL,
    FOREIGN KEY(itemID) REFERENCES Items(id),
    FOREIGN KEY(previewID) REFERENCES Previews(id)
);
CREATE TABLE IF NOT EXISTS ItemTags (
    itemID INTEGER NOT NULL,
    tagID INTEGER NOT NULL,
    FOREIGN KEY(itemID) REFERENCES Items(id),
    FOREIGN KEY(tagID) REFERENCES Tags(id)
);